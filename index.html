<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BTC 10 L·ªánh/Ng√†y - Fix</title>
    <style>
        body { background: #0b0e11; color: white; font-family: sans-serif; text-align: center; padding: 20px; }
        .box { background: #1e2329; border: 2px solid #f0b90b; border-radius: 15px; padding: 20px; margin-bottom: 20px; }
        .price { font-size: 35px; font-weight: bold; color: #f0b90b; margin: 10px 0; }
        .rsi { font-size: 20px; color: #2ebd85; }
        input { width: 100%; padding: 15px; margin: 10px 0; border-radius: 8px; border: 1px solid #444; background: #2b3139; color: white; font-size: 16px; }
        button { width: 100%; padding: 15px; background: #f0b90b; border: none; font-weight: bold; border-radius: 8px; cursor: pointer; font-size: 18px; }
        #log { font-size: 12px; color: #848e9c; margin-top: 20px; text-align: left; height: 100px; overflow-y: scroll; border: 1px solid #333; padding: 5px; }
    </style>
</head>
<body>

    <div class="box">
        <div style="color: #848e9c;">GI√Å BTC EXNESS</div>
        <div id="displayPrice" class="price">ƒêANG T·∫¢I...</div>
        <div class="rsi">RSI (1M): <span id="displayRSI">--</span></div>
    </div>

    <input type="number" id="inputPrice" placeholder="Nh·∫≠p gi√° BTC Exness v√†o ƒë√¢y...">
    <button onclick="sync()">K√çCH HO·∫†T (SYNC)</button>

    <div id="log">Nh·∫≠t k√Ω h·ªá th·ªëng: ƒêang kh·ªüi ƒë·ªông...</div>

    <script>
        const TG_TOKEN = "7553580554:AAH3kP7CidTzUvF3LzDOnn8X_80-O96M78E";
        const CHAT_ID = "5919747180";
        let offset = 0;

        function addLog(msg) {
            const log = document.getElementById('log');
            log.innerHTML += `<div>> ${msg}</div>`;
            log.scrollTop = log.scrollHeight;
        }

        function sync() {
            const val = parseFloat(document.getElementById('inputPrice').value);
            fetch('https://api.binance.com/api/v3/ticker/price?symbol=BTCUSDT')
                .then(r => r.json())
                .then(data => {
                    const binancePrice = parseFloat(data.price);
                    offset = val - binancePrice;
                    addLog(`ƒê√£ kh·ªõp gi√°! ƒê·ªô l·ªách: ${offset.toFixed(2)}`);
                    alert("ƒê√£ ƒë·ªìng b·ªô th√†nh c√¥ng!");
                });
        }

        function update() {
            fetch('https://api.binance.com/api/v3/klines?symbol=BTCUSDT&interval=1m&limit=30')
                .then(r => r.json())
                .then(data => {
                    const prices = data.map(d => parseFloat(d[4]));
                    const lastPrice = prices[prices.length - 1];
                    
                    // T√≠nh RSI nhanh
                    let gains = 0, losses = 0;
                    for (let i = prices.length - 14; i < prices.length; i++) {
                        let diff = prices[i] - prices[i-1];
                        if (diff >= 0) gains += diff; else losses -= diff;
                    }
                    const rsi = 100 - (100 / (1 + (gains / losses)));

                    document.getElementById('displayPrice').innerText = (lastPrice + offset).toFixed(2);
                    document.getElementById('displayRSI').innerText = rsi.toFixed(2);

                    if (rsi >= 55) sendTele(`üöÄ BTC SELL: ${(lastPrice + offset).toFixed(2)} (RSI: ${rsi.toFixed(2)})`);
                    if (rsi <= 45) sendTele(`üî• BTC BUY: ${(lastPrice + offset).toFixed(2)} (RSI: ${rsi.toFixed(2)})`);
                })
                .catch(err => addLog("L·ªói k·∫øt n·ªëi: " + err));
        }

        function sendTele(msg) {
            fetch(`https://api.telegram.org/bot${TG_TOKEN}/sendMessage?chat_id=${CHAT_ID}&text=${encodeURIComponent(msg)}`);
        }

        setInterval(update, 5000); // C·∫≠p nh·∫≠t m·ªói 5 gi√¢y
    </script>
</body>
</html>
