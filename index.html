<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BOT V√ÄNG & BTC CHU·∫®N</title>
    <style>
        body { background: #0b0e11; color: white; font-family: sans-serif; padding: 10px; }
        .box { border: 2px solid #f0b90b; border-radius: 12px; padding: 15px; background: #1c1f24; margin-bottom: 10px; }
        .price { font-size: 32px; font-weight: bold; color: #f0b90b; }
        .rsi { font-size: 20px; color: #2ebd85; margin: 5px 0; }
        input { width: 90%; padding: 12px; margin: 10px 0; border-radius: 8px; border: 1px solid #444; background: #1e2329; color: white; }
        button { width: 100%; padding: 15px; background: #2ebd85; color: white; font-weight: bold; border-radius: 10px; border: none; cursor: pointer; font-size: 18px; }
        #status { font-size: 12px; color: #848e9c; margin-top: 10px; }
    </style>
</head>
<body>
    <div class="box">
        <div>XAU/USD (V√ÄNG EXNESS)</div>
        <div id="goldPrice" class="price">--</div>
        <div id="goldRsi" class="rsi">RSI: --</div>
        <input type="number" id="exGold" step="0.01" placeholder="Nh·∫≠p gi√° V√†ng Exness hi·ªán t·∫°i...">
    </div>

    <div class="box">
        <div>BTC/USD (BTC EXNESS)</div>
        <div id="btcPrice" class="price">--</div>
        <div id="btclRsi" class="rsi">RSI: --</div>
        <input type="number" id="exBtc" step="0.01" placeholder="Nh·∫≠p gi√° BTC Exness hi·ªán t·∫°i...">
    </div>

    <button onclick="activate()">K√çCH HO·∫†T H·ªÜ TH·ªêNG</button>
    <div id="status">Tr·∫°ng th√°i: ƒêang ƒë·ª£i bro...</div>

    <script>
        const TOKEN = "8586899878:AAHONzWJqzUMswUPMjn5xaWvYrwDHSH4OYE";
        const CHAT_ID = "7994694689";
        let gOff = 0, bOff = 0;
        let lastG = "", lastB = "";

        async function activate() {
            const gV = parseFloat(document.getElementById('exGold').value) || 0;
            const bV = parseFloat(document.getElementById('exBtc').value) || 0;
            
            // Sync gi√° th·ª±c t·∫ø
            const [rg, rb] = await Promise.all([
                fetch('https://api.binance.com/api/v3/ticker/price?symbol=PAXGUSDT').then(r => r.json()),
                fetch('https://api.binance.com/api/v3/ticker/price?symbol=BTCUSDT').then(r => r.json())
            ]);
            
            gOff = gV ? gV - parseFloat(rg.price) : 0;
            bOff = bV ? bV - parseFloat(rb.price) : 0;

            document.getElementById('status').innerText = "üöÄ BOT ƒêANG QU√âT C·∫¢ V√ÄNG & BTC...";
            sendTele("üéØ H·ªÜ TH·ªêNG ƒê√É K√çCH HO·∫†T!\nüíé Ch·ªù k√®o V√†ng & BTC c√≥ SL/TP...");
            setInterval(scan, 3000); // TƒÉng t·ªëc ƒë·ªô qu√©t l√™n 3 gi√¢y/l·∫ßn
        }

        async function scan() {
            // Qu√©t V√†ng
            const gData = await getRSI('PAXGUSDT');
            handleSignal("GOLD", gData.rsi, gData.last + gOff, 65, 35, 2, 5); // SL 2 gi√°, TP 5 gi√° cho V√†ng

            // Qu√©t BTC
            const bData = await getRSI('BTCUSDT');
            handleSignal("BTC", bData.rsi, bData.last + bOff, 65, 35, 400, 800); // SL 400 gi√°, TP 800 gi√° cho BTC
        }

        async function getRSI(s) {
            const r = await fetch(`https://api.binance.com/api/v3/klines?symbol=${s}&interval=1m&limit=30`);
            const d = await r.json();
            const p = d.map(x => parseFloat(x[4]));
            let g = 0, l = 0;
            for (let i = p.length - 14; i < p.length; i++) {
                let diff = p[i] - p[i-1];
                if (diff >= 0) g += diff; else l -= diff;
            }
            return { rsi: 100 - (100 / (1 + (g / l))), last: p[p.length - 1] };
        }

        function handleSignal(name, rsi, price, hi, lo, slDist, tpDist) {
            const rsiElem = name === "GOLD" ? "goldRsi" : "btclRsi";
            const prElem = name === "GOLD" ? "goldPrice" : "btcPrice";
            document.getElementById(prElem).innerText = price.toFixed(2);
            document.getElementById(rsiElem).innerText = "RSI: " + rsi.toFixed(2);

            let side = "";
            if (rsi >= hi) side = "SELL";
            else if (rsi <= lo) side = "BUY";

            let last = name === "GOLD" ? lastG : lastB;

            if (side !== "" && side !== last) {
                const sl = side === "SELL" ? price + slDist : price - slDist;
                const tp = side === "SELL" ? price - tpDist : price + tpDist;
                
                let m = `üîî [K√àO ${name} ${side}]\nüìç Entry: ${price.toFixed(2)}\nüö´ SL: ${sl.toFixed(2)}\n‚úÖ TP: ${tp.toFixed(2)}\nüìä RSI: ${rsi.toFixed(2)}`;
                sendTele(m);
                if (name === "GOLD") lastG = side; else lastB = side;
            } else if (rsi > 45 && rsi < 55) {
                if (name === "GOLD") lastG = ""; else lastB = "";
            }
        }

        function sendTele(m) {
            fetch(`https://api.telegram.org/bot${TOKEN}/sendMessage?chat_id=${CHAT_ID}&text=${encodeURIComponent(m)}`);
        }
    </script>
</body>
</html>
