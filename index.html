<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BTC 10 L·ªánh/Ng√†y Bot</title>
    <script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
    <style>
        body { background: #0b0e11; color: white; font-family: sans-serif; margin: 0; padding: 10px; }
        .card { background: #1e2329; border-radius: 12px; padding: 15px; border: 1px solid #f0b90b; text-align: center; }
        .price { font-size: 32px; font-weight: bold; color: #f0b90b; margin: 10px 0; }
        .rsi { font-size: 18px; color: #2ebd85; }
        input { width: 100%; padding: 12px; background: #2b3139; border: 1px solid #444; color: white; border-radius: 8px; margin: 10px 0; box-sizing: border-box; }
        button { width: 100%; padding: 15px; background: #f0b90b; border: none; font-weight: bold; border-radius: 8px; cursor: pointer; }
        #chart { height: 300px; margin-top: 10px; }
    </style>
</head>
<body>

    <div class="card">
        <div style="font-size: 12px; color: #848e9c;">GI√Å BTC KH·ªöP S√ÄN</div>
        <div id="syncedPrice" class="price">ƒêang k·∫øt n·ªëi...</div>
        <div class="rsi">RSI (1M): <span id="rsiVal">--</span></div>
    </div>

    <input type="number" id="exnessPrice" placeholder="Nh·∫≠p gi√° BTC Exness...">
    <button onclick="syncPrice()">K√çCH HO·∫†T BOT (SYNC)</button>

    <div id="chart"></div>

    <script>
        // TH√îNG S·ªê SI√äU NH·∫†Y ƒê·ªÇ C√ì 10 L·ªÜNH/NG√ÄY
        const CONFIG = {
            symbol: "BTCUSDT",
            interval: "1m", 
            rsiUpper: 55, // H·∫° t·ª´ 60 xu·ªëng 55 ƒë·ªÉ b√°o SELL nhi·ªÅu h∆°n
            rsiLower: 45, // TƒÉng t·ª´ 40 l√™n 45 ƒë·ªÉ b√°o BUY nhi·ªÅu h∆°n
            telegramToken: "7553580554:AAH3kP7CidTzUvF3LzDOnn8X_80-O96M78E",
            chatId: "5919747180"
        };

        let currentOffset = 0, lastBinancePrice = 0;
        const chart = LightweightCharts.createChart(document.getElementById('chart'), {
            layout: { backgroundColor: '#1e2329', textColor: '#d1d4dc' },
            grid: { vertLines: { color: '#2b3139' }, horzLines: { color: '#2b3139' } }
        });
        const candleSeries = chart.addCandlestickSeries();

        function syncPrice() {
            const exPrice = parseFloat(document.getElementById('exnessPrice').value);
            if (exPrice && lastBinancePrice) {
                currentOffset = exPrice - lastBinancePrice;
                alert("ƒê√£ ƒë·ªìng b·ªô! ƒê·ª£i k√®o n·ªï nh√© bro!");
            }
        }

        async function updateBot() {
            try {
                const resp = await fetch(`https://api.binance.com/api/v3/klines?symbol=${CONFIG.symbol}&interval=${CONFIG.interval}&limit=50`);
                const data = await resp.json();
                const prices = data.map(d => parseFloat(d[4]));
                lastBinancePrice = prices[prices.length - 1];
                
                const rsi = calculateRSI(prices);
                document.getElementById('rsiVal').innerText = rsi.toFixed(2);
                document.getElementById('syncedPrice').innerText = (lastBinancePrice + currentOffset).toFixed(2);

                // G·ª≠i k√®o si√™u nh·∫°y
                if (rsi >= CONFIG.rsiUpper) sendTele(`üöÄ K√àO SELL BTC (NHANH)\nRSI: ${rsi.toFixed(2)}\nGi√°: ${(lastBinancePrice + currentOffset).toFixed(2)}`);
                if (rsi <= CONFIG.rsiLower) sendTele(`üî• K√àO BUY BTC (NHANH)\nRSI: ${rsi.toFixed(2)}\nGi√°: ${(lastBinancePrice + currentOffset).toFixed(2)}`);

            } catch (e) { console.log(e); }
        }

        function calculateRSI(prices) {
            let gains = 0, losses = 0;
            for (let i = prices.length - 14; i < prices.length; i++) {
                let diff = prices[i] - prices[i - 1];
                if (diff >= 0) gains += diff; else losses -= diff;
            }
            return 100 - (100 / (1 + (gains / losses)));
        }

        function sendTele(msg) {
            fetch(`https://api.telegram.org/bot${CONFIG.telegramToken}/sendMessage?chat_id=${CONFIG.chatId}&text=${encodeURIComponent(msg)}`);
        }

        setInterval(updateBot, 3000); 
    </script>
</body>
</html>
