<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Si√™u Bot Gold & BTC 24/7</title>
    <script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
    <style>
        body { background: #131722; color: white; font-family: sans-serif; margin: 0; padding: 10px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px; }
        .box { background: #1e222d; padding: 15px; border-radius: 8px; text-align: center; border: 1px solid #363a45; }
        .label { font-size: 12px; color: #848e9c; margin-bottom: 5px; text-transform: uppercase; }
        .value { font-size: 20px; font-weight: bold; color: #f0b90b; }
        input { width: 80%; padding: 10px; background: #2a2e39; border: 1px solid #444; color: white; border-radius: 4px; margin-bottom: 10px; }
        button { width: 100%; padding: 12px; background: #f0b90b; border: none; font-weight: bold; cursor: pointer; border-radius: 4px; }
        #chart { height: 300px; margin-top: 10px; border-radius: 8px; overflow: hidden; }
        .status { background: #f0b90b; color: black; padding: 10px; border-radius: 8px; text-align: center; font-weight: bold; margin-top: 10px; }
    </style>
</head>
<body>

    <input type="number" id="exnessPrice" placeholder="Nh·∫≠p gi√° Exness hi·ªán t·∫°i...">
    <button onclick="syncPrice()">SYNC (KH·ªöP GI√Å)</button>

    <div class="grid" style="margin-top:15px;">
        <div class="box"><div class="label">C·∫∑p T√†i S·∫£n</div><div id="symbolLabel" class="value">XAU/BTC</div></div>
        <div class="box"><div class="label">RSI (C·ª±c Nh·∫°y)</div><div id="rsiVal" class="value">--</div></div>
        <div class="box"><div class="label">L·ªách (Offset)</div><div id="offsetVal" class="value">0.00</div></div>
        <div class="box"><div class="label">Gi√° ƒê√£ Kh·ªõp</div><div id="syncedPrice" class="value">--</div></div>
    </div>

    <div id="status" class="status">BOT ƒêANG QU√âT: XAUUSD & BTCUSDT (M1)</div>
    <div id="chart"></div>

    <script>
        // C·∫§U H√åNH SI√äU NH·∫†Y
        const CONFIG = {
            symbols: ["XAUUSD", "BTCUSDT"], 
            interval: "1m", // Khung 1 ph√∫t ƒë·ªÉ nhi·ªÅu l·ªánh
            rsiPeriod: 14,
            rsiUpper: 60, // Ch·∫°m 60 b√°o SELL (Nhi·ªÅu k√®o h∆°n)
            rsiLower: 40, // Ch·∫°m 40 b√°o BUY (Nhi·ªÅu k√®o h∆°n)
            telegramToken: "7553580554:AAH3kP7CidTzUvF3LzDOnn8X_80-O96M78E", 
            chatId: "5919747180" 
        };

        let currentOffset = 0;
        let lastBinancePrice = 0;

        function syncPrice() {
            const exPrice = parseFloat(document.getElementById('exnessPrice').value);
            if (exPrice && lastBinancePrice) {
                currentOffset = exPrice - lastBinancePrice;
                document.getElementById('offsetVal').innerText = currentOffset.toFixed(2);
                alert("ƒê√£ ƒë·ªìng b·ªô th√†nh c√¥ng!");
            }
        }

        // Kh·ªüi t·∫°o bi·ªÉu ƒë·ªì Lightweight Charts
        const chart = LightweightCharts.createChart(document.getElementById('chart'), {
            layout: { backgroundColor: '#131722', textColor: '#d1d4dc' },
            grid: { vertLines: { color: '#2b2b43' }, horzLines: { color: '#2b2b43' } },
            timeScale: { timeVisible: true, secondsVisible: false }
        });
        const candleSeries = chart.addCandlestickSeries();

        async function fetchData() {
            for (let sym of CONFIG.symbols) {
                try {
                    const resp = await fetch(`https://api.binance.com/api/v3/klines?symbol=${sym}&interval=${CONFIG.interval}&limit=100`);
                    const data = await resp.json();
                    
                    const prices = data.map(d => parseFloat(d[4]));
                    lastBinancePrice = prices[prices.length - 1];
                    
                    // T√≠nh RSI ƒë∆°n gi·∫£n
                    const rsi = calculateRSI(prices);
                    document.getElementById('rsiVal').innerText = rsi.toFixed(2);
                    document.getElementById('syncedPrice').innerText = (lastBinancePrice + currentOffset).toFixed(2);

                    // G·ª≠i th√¥ng b√°o Telegram n·∫øu ch·∫°m ng∆∞·ª°ng
                    if (rsi >= CONFIG.rsiUpper) sendTele(`üö® K√àO SELL ${sym}\nRSI: ${rsi.toFixed(2)}\nGi√°: ${(lastBinancePrice + currentOffset).toFixed(2)}`);
                    if (rsi <= CONFIG.rsiLower) sendTele(`‚úÖ K√àO BUY ${sym}\nRSI: ${rsi.toFixed(2)}\nGi√°: ${(lastBinancePrice + currentOffset).toFixed(2)}`);

                } catch (e) { console.error(e); }
            }
        }

        function calculateRSI(prices) {
            let gains = 0, losses = 0;
            for (let i = prices.length - 14; i < prices.length; i++) {
                let diff = prices[i] - prices[i - 1];
                if (diff >= 0) gains += diff; else losses -= diff;
            }
            return 100 - (100 / (1 + (gains / losses)));
        }

        function sendTele(msg) {
            fetch(`https://api.telegram.org/bot${CONFIG.telegramToken}/sendMessage?chat_id=${CONFIG.chatId}&text=${encodeURIComponent(msg)}`);
        }

        setInterval(fetchData, 5000); // Qu√©t m·ªói 5 gi√¢y
    </script>
</body>
</html>
